<?xml version="1.0" encoding="UTF-8"?>
<!-- 혹시 나중에 에러나면 이 친구 때문"Spring Elements/Beans/web-context/beans:beans" -->
<beans:beans xmlns="http://www.springframework.org/schema/security"
	xmlns:beans="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
	 http://www.springframework.org/schema/beans/spring-beans.xsd
	 http://www.springframework.org/schema/security
	 http://www.springframework.org/schema/security/spring-security.xsd">
	 
	 <http use-expressions="true">
	 	<intercept-url pattern="/books/add" access="hasAuthority('ROLE_ADMIN')"/>
	 	
	 	<form-login login-page="/login"
	 		default-target-url="/books/add"
	 		authentication-failure-url="/loginfailed"
	 		username-parameter="username"
	 		password-parameter="password"/>
	 	<csrf/>
	 	<logout logout-success-url="/logout"/>
	 </http>
	 <authentication-manager>
	 	<authentication-provider>
	 		<user-service properties="WEB-INF/user/users.properties"/>
	 	</authentication-provider>
	 </authentication-manager> 
</beans:beans>
